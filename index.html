<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Шаблоны МЭС</title>
	
	  <!-- Добавлена иконка сайта Мосэнергосбыт -->
    <link rel="icon" href="https://www.mosenergosbyt.ru/favicon.ico" type="image/x-icon">
	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
.btn-link {
            width: 100%;
            text-align: left;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50 !important;
            text-decoration: none !important;
            border-radius: 8px;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
            border-left: 4px solid transparent;
        }
        
        .btn-link:hover {
            background-color: #e9ecef;
            border-left: 4px solid #3498db;
        }
        
        /* Исправленный стиль для paymentDateGroup */
        #paymentDateGroup {
            display: none;
        }
    </style>

<!--Стиль тем письма-->


<style>
/* Центрирование всего блока */
.email-templates-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 20px 0;
}

/* Стиль для строки с темой писем */
.template-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    font-size: 15px;
    color: #495057;
}

/* Стиль для кнопок тем писем */
.template-option {
    padding: 6px 12px;
    margin: 0 5px;
    border-radius: 16px;
    background: #f8f9fa;
    color: #212529;
    cursor: pointer;
    transition: all 0.2s;
    border: 1px solid #dee2e6;
    font-size: 14px;
}

.template-option:hover {
    background: #e9ecef;
    border-color: #adb5bd;
}

.template-option.active {
    background: #007bff;
    color: white;
    border-color: #007bff;
}

/* Разделитель */
.template-divider {
    color: #adb5bd;
    margin: 0 5px;
}

/* Стиль для кнопок действий */
.action-btn {
    padding: 8px 16px;
    margin: 5px;
    border-radius: 6px;
    border: none;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    min-width: 120px;
}

.action-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Цвета кнопок */
.btn-mkd { background: #6c757d; color: white; }
.btn-igd-asumb { background: #28a745; color: white; }
.btn-igd { background: #fd7e14; color: white; }
.btn-pd { background: #007bff; color: white; }
.btn-akt { background: #17a2b8; color: white; }

/* Контейнер для кнопок */
.actions-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 10px;
}
</style>




<!--Стиль кнопок-->

<style>
.action-btn {
    position: relative;
    padding: 15px 20px 15px 60px;
    margin: 0 10px 15px 0;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    font-size: 15px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: left;
    color: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    overflow: hidden;
}

.action-btn::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 40px;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
}

.action-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

/* Конкретные стили для каждой кнопки */
.btn-mkd {
    background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
}
.btn-mkd::before {
    content: '\f1ad';
    background: rgba(0,0,0,0.1);
}

.btn-igd-asumb {
    background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
}
.btn-igd-asumb::before {
    content: '\f015';
    background: rgba(0,0,0,0.1);
}

.btn-igd {
    background: linear-gradient(135deg, #fd7e14 0%, #e36209 100%);
}
.btn-igd::before {
    content: '\f7b2';
    background: rgba(0,0,0,0.1);
}

.btn-pd {
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
}
.btn-pd::before {
    content: '\f571';
    background: rgba(0,0,0,0.1);
}

.btn-akt {
    background: linear-gradient(135deg, #17a2b8 0%, #117a8b 100%);
}
.btn-akt::before {
    content: '\f46c';
    background: rgba(0,0,0,0.1);
}

.btn-badge {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 3px;
}
</style>


    <!-- bootstrap4 -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- bootstrap4 -->

 <style type="text/css">
      #bloknot {
        width: 150px; position: fixed;
        z-index: 999;
        right: 0;
        transition: cubic-bezier(.61,1.95,.26,.95) .5s;
      }
      .text-template {
        cursor: pointer;
        color: #007bff;
        text-decoration: underline;
      }
      .text-template:hover {
        color: #0056b3;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
  
  <!--<style>
  body {
    background-image: url('https://krasnogorsk-adm.ru/netcat_files/3/1/Mosenergosbyt.png');
    background-repeat: no-repeat;
    background-size: cover;
  }
</style>
-->

<textarea class="form-control" rows="3" id="bloknot"></textarea>

    <div id="accordion">
      <div class="card">
        <div class="card-header" id="headingOne">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Корректировки
            </button>
          </h5>
        </div>
        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
          <div class="container mt-3">
		  
		 

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Не согласен с показаниями "Сети", Сетевой участок Россети МР; Дата сети
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="sDate">; То
  <input type="text" style="width: 60px" maxlength="6" id="sT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="sT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="sT2"> ; Т3
  <input type="text" style="width: 60px" maxlength="6" id="sT3"> ;
    </span><span class="input-group-text">Дата кл 
  <input class="thisDate" oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="cDate">; То 
  <input type="text" style="width: 60px" maxlength="6" id="cT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="cT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="cT2"> ; Т3 
  <input type="text" style="width: 60px" maxlength="6" id="cT3"> ;
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="fnCopy1()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Клиент ошибочно передал показания
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="fDate">; То
  <input type="text" style="width: 60px" maxlength="6" id="fT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="fT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="fT2"> ; Т3
  <input type="text" style="width: 60px" maxlength="6" id="fT3"> ;
    </span><span class="input-group-text">Корректировочные показания на 
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="tDate">; То 
  <input type="text" style="width: 60px" maxlength="6" id="tT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="tT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="tT2"> ; Т3 
  <input type="text" style="width: 60px" maxlength="6" id="tT3"> ;
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="fnCopy2()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="f1Date"> клиент ошибочно передал показания То-
  <input type="text" style="width: 60px" maxlength="6" id="f1T0">, Т1-
  <input type="text" style="width: 60px" maxlength="6" id="f1T1">, Т2-
  <input type="text" style="width: 60px" maxlength="6" id="f1T2">, Т3-
  <input type="text" style="width: 60px" maxlength="6" id="f1T3">, данные показания необходимо удалить.
    </span><span class="input-group-text">Корректные показания на 
  <input class="thisDate" oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="t1Date"> То-
  <input type="text" style="width: 60px" maxlength="6" id="t1T0">, Т1- 
  <input type="text" style="width: 60px" maxlength="6" id="t1T1">, Т2- 
  <input type="text" style="width: 60px" maxlength="6" id="t1T2">, Т3- 
  <input type="text" style="width: 60px" maxlength="6" id="t1T3">
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="fnCopy3()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
  <h5>Расчет new</h5>
   <div class="input-group">
    <span class="input-group-text">
  Показания на начало периода &nbsp;
  <input type="text" style="width: 90px" id="nrDate1" placeholder="Дата">, Т1-
  <input type="text" style="width: 60px" id="nrT1">, Т2-
  <input type="text" style="width: 60px" id="nrT2">, Т3-
  <input type="text" style="width: 60px" id="nrT3">
    </span><span class="input-group-text">Текущие показания &nbsp;
  <input type="text" style="width: 90px" id="nrDate2" placeholder="Дата">, Т1-
  <input type="text" style="width: 60px" id="nr1T1">, Т2-
  <input type="text" style="width: 60px" id="nr1T2">, Т3-
  <input type="text" style="width: 60px" id="nr1T3">
    </span><span class="input-group-text">Дата показаний, которые нужно корректировать &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
  <input type="text" style="width: 90px" class="nrItog" placeholder="Дата"> &nbsp;
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="nr()">Рассчитать</button>
</div>

</div>

    </div>
  </div>

  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Жалоба на сроки доставки ПД
        </button>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">
<div class="container-fluid">
  
<table class="table table-striped">
  <thead>
  </thead>
  <tbody>
<script type="text/javascript">
  const month_1 = ["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];
  const d = new Date();
  if (d.getMonth() == 0) {var name = month_1[d.getMonth()+11]} else {var name = month_1[d.getMonth()-1]}
    document.write(`
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). В ЛС адрес клиента указан верно (сотрудник должен сверить адрес доставки ПД);</td>
    </tr>
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). В ЛС адрес клиента указан верно. Со слов клиента квитанции за ${name} (месяц) не получил весь дом.</td>
    </tr>
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). Альтернативный адрес сверен.</td>
    </tr>
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). В ЛС адрес клиента указан верно. Квитанции разбросаны по всей улице (дому).</td>
    </tr>
      `)
</script>
  </tbody>
</table>

</div>

      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          Заявка на изменение реквизитов
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse show" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Клиенту поступают звонки/смс/ E-mail на телефон 
    <input type="text" style="width: 60px" id="phone_1"> /на E-mail 
    <input type="text" style="width: 60px" id="mail_1">  о задолженности по ЛС
    <input type="text" style="width: 60px" id="ls_1" onchange="ls_11.value = this.value"> . Клиент не имеет отношение к ЛС 
    <input type="text" style="width: 60px" id="ls_11" disabled> . 
    </span><span class="input-group-text">Дата информирования 
    <input type="date" id="date_1"/>. Автообзвон/ E-mail информирование/Росдолг, ручной обзвон/смс-оповещение.
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="rekviz1()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Клиенту на E-mail 
    <input type="text" style="width: 60px" id="mail_2" onchange="mail_22.value = this.value"> поступила электронная квитанция по ЛС 
    <input type="text" style="width: 60px" id="ls_2"> . Клиент отказывается от получения эл. счетов. Адрес электронной почты 
    <input type="text" style="width: 60px" id="mail_22" disabled> необходимо удалить из биллинга
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="rekviz2()">Скопировать</button>
</div>

      </div>
    </div>
  </div>
</div>

  <!-- Новая вкладка "Жалоба на отключение ЭЭ" -->
      <div class="card">
        <div class="card-header" id="headingFour">
          <h5 class="mb-0">
            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
              Жалоба на отключение ЭЭ
            </button>
          </h5>
        </div>
        <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
          <div class="card-body">
            <div class="container mt-3">
              <div class="alert alert-primary center" role="alert">
                <div class="form-group">
                  <label>Тип жалобы:</label>
                  <div class="btn-group w-100">
                    <button type="button" class="btn btn-outline-primary" onclick="selectComplaintType('Ошибочное отключение')">Ошибочное отключение</button>
                    <button type="button" class="btn btn-outline-primary" onclick="selectComplaintType('Нарушен срок возобновления')">Нарушен срок возобновления</button>
                  </div>
                </div>

                <div class="form-group mt-3" id="selectedTheme" style="display: none;">
                  <label>Тема письма:</label>
                  <span id="themeText" class="text-template" onclick="copyThemeText()"></span>
                </div>

                <div class="form-group mt-3" id="confirmationTypeGroup" style="display: none;">
                  <label>Подтверждение:</label>
                  <div class="btn-group w-100">
                    <button type="button" class="btn btn-outline-secondary" onclick="selectConfirmationType('Подтвердил через почту')">Подтвердил через почту</button>
                    <button type="button" class="btn btn-outline-secondary" onclick="selectConfirmationType('Подтверждено в КО')">Подтверждено в КО</button>
                  </div>
                </div>

               <div class="form-group mt-3" id="complaintDateGroup" style="display: none;">
                  <label for="complaintDate">Дата оплаты:</label>
                  <input type="date" class="form-control" id="complaintDate" onchange="syncPaymentDate(this.value)">
                </div>

                <div class="form-group">
                  <label for="complaintPhone">Телефон для связи:</label>
                  <input type="text" class="form-control" id="complaintPhone" placeholder="Номер телефона">
                </div>

                <div class="form-group" id="emailGroup" style="display: none;">
                  <label for="complaintEmail">Электронная почта:</label>
                  <input type="email" class="form-control" id="complaintEmail" placeholder="Email">
                </div>
                <div class="form-group" id="paymentDateGroup" style="display: none;">
                  <label for="paymentDate">Дата отправки чека:</label>
                  <input type="date" class="form-control" id="paymentDate">
                </div>

                <button type="button" class="btn btn-primary mt-2" onclick="copyComplaint()">Скопировать</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
	
	 <!-- Новая вкладка "Жалоба на сроки заключения договора" -->
      <div class="card">
        <div class="card-header" id="headingFive">
          <h5 class="mb-0">
            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
              Жалоба на сроки заключения договора
            </button>
          </h5>
        </div>
        <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
          <div class="card-body">
            <div class="container mt-3">
              <div class="alert alert-primary center" role="alert">
                <div class="form-group">
                  <label>Тип подачи:</label>
                  <div class="btn-group w-100">
                    <button type="button" class="btn btn-outline-primary" onclick="selectContractType('Подача в ЛКК')">Подача в ЛКК</button>
                    <button type="button" class="btn btn-outline-primary" onclick="selectContractType('Подача в КО')">Подача в КО</button>
                  </div>
                </div>

                <div class="form-group mt-3">
                  <label for="contractDate">Дата обращения:</label>
                  <input type="date" class="form-control" id="contractDate">
                </div>

                <div class="form-group" id="requestNumberGroup" style="display: none;">
                  <label for="requestNumber">Номер заявки:</label>
                  <input type="text" class="form-control" id="requestNumber" placeholder="Номер заявки" maxlength="20">
                </div>

                <div class="form-group">
                  <label for="clientNumber">Номер клиента:</label>
                  <input type="text" class="form-control" id="clientNumber" placeholder="Номер клиента" maxlength="15">
                </div>

                <div class="form-group" id="officeAddressGroup" style="display: none;">
                  <label for="officeAddress">Адрес/название КО:</label>
                  <input type="text" class="form-control" id="officeAddress" placeholder="Адрес или название КО">
                </div>

                <button type="button" class="btn btn-primary mt-2" onclick="copyContractComplaint()">Скопировать</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
	
<div class="container-fluid email-templates-container">
    <div class="template-header">
        <span class="mr-2">Темы писем:</span>
        <span class="template-option" onclick="copyTemplate(0)">Восстановление электроэнергии</span>
        <span class="template-divider">|</span>
        <span class="template-option" onclick="copyTemplate(1)">Квитанция АО Мосэнергосбыт</span>
        <span class="template-divider">|</span>
        <span class="template-option" onclick="copyTemplate(2)">Акт сверки АО Мосэнергосбыт</span>
    </div>

    <div class="actions-container">
        <button type="button" class="action-btn btn-mkd" onclick="send_mail('MKD')">Восстановление МКД</button>
        <button type="button" class="action-btn btn-igd-asumb" onclick="send_mail('IGD_asumb')">ИЖД АСУМБ</button>
        <button type="button" class="action-btn btn-igd" onclick="send_mail('IGD')">Восстановление ИЖД</button>
        <button type="button" class="action-btn btn-pd" onclick="send_mail('PD')">Квитанция</button>
        <button type="button" class="action-btn btn-akt" onclick="send_mail('Akt')">Акт сверки</button>
    </div>
</div>
      

    <script type="text/javascript">

    //Корректировка
    function fnCopy1() {
       navigator.clipboard.writeText(`Не согласен с показаниями "Сети",  Сетевой участок Россети МР; Дата сети ${sDate.value}; То ${sT0.value} ; Т1 ${sT1.value} ; Т2 ${sT2.value} ; Т3 ${sT3.value} ; Дата кл ${cDate.value}; То ${cT0.value} ; Т1 ${cT1.value} ; Т2 ${cT2.value} ; Т3 ${cT3.value} ;`)
    }
    function fnCopy2() {
      if (fT3.value == '' && fT0.value== '') {
       navigator.clipboard.writeText(`Клиент ошибочно передал показания ${fDate.value} Т1 ${fT1.value} ; Т2 ${fT2.value} ; Корректировочные показания на ${tDate.value} Т1 ${tT1.value} ; Т2 ${tT2.value} ;`)
      }
     else if (fT0.value == '') {
       navigator.clipboard.writeText(`Клиент ошибочно передал показания ${fDate.value} Т1 ${fT1.value} ; Т2 ${fT2.value} ; Т3 ${fT3.value} ; Корректировочные показания на ${tDate.value} Т1 ${tT1.value} ; Т2 ${tT2.value} ; Т3 ${tT3.value} ;`)
     }
      else {
       navigator.clipboard.writeText(`Клиент ошибочно передал показания ${fDate.value} То ${fT0.value} ; Корректировочные показания на ${tDate.value} То ${tT0.value} ;`)
      }
    }
    function fnCopy3() {
      if (f1T3.value == '' && f1T0.value== '') {
       navigator.clipboard.writeText(`${f1Date.value} клиент ошибочно передал показания Т1-${f1T1.value}, Т2-${f1T2.value}, данные показания необходимо удалить. Корректные показания на ${t1Date.value}, Т1-${t1T1.value}, Т2-${t1T2.value}.`)
      }
     else if (f1T0.value == '') {
       navigator.clipboard.writeText(`${f1Date.value} клиент ошибочно передал показания Т1-${f1T1.value}, Т2-${f1T2.value}, Т3-${f1T3.value}, данные показания необходимо удалить. Корректные показания на ${t1Date.value}, Т1-${t1T1.value}, Т2-${t1T2.value}, Т3-${t1T3.value}.`)
     }
      else {
       navigator.clipboard.writeText(`${f1Date.value} клиент ошибочно передал показания То-${f1T0.value}, данные показания необходимо удалить. Корректные показания на ${t1Date.value}, То-${t1T0.value}.`)
      }
    }
    //Корректировка




    //Изменение реквизитов
    function rekviz1() {
      if (phone_1.value == '') {
        navigator.clipboard.writeText(`Клиенту поступают E-mail на E-mail ${mail_1.value}  о задолженности по ЛС ${ls_1.value}. Клиент не имеет отношение к ЛС ${ls_1.value}. Дата информирования ${date_1.value}. E-mail информирование.`)
      } 
        else if (mail_1.value == '') {
         navigator.clipboard.writeText(`Клиенту поступают звонки/смс на телефон ${phone_1.value} о задолженности по ЛС ${ls_1.value}. Клиент не имеет отношение к ЛС ${ls_1.value}. Дата информирования ${date_1.value}. Автообзвон/Росдолг, ручной обзвон/смс-оповещение.`)
        }
          else {
           navigator.clipboard.writeText(`Клиенту поступают звонки/смс/ E-mail на телефон ${phone_1.value} /на E-mail ${mail_1.value}  о задолженности по ЛС ${ls_1.value} . Клиент не имеет отношение к ЛС ${ls_1.value} . Дата информирования ${date_1.value} . Автообзвон/ E-mail информирование/Росдолг, ручной обзвон/смс-оповещение.`)
          }
    }

    function rekviz2() {
      navigator.clipboard.writeText(`Клиенту на E-mail ${mail_2.value} поступила электронная квитанция по ЛС ${ls_2.value} . Клиент отказывается от получения эл. счетов. Адрес электронной почты ${mail_22.value} необходимо удалить из биллинга`)
    }
    //Изменение реквизитов

    //Письма
   var send_mail_arr = {
      MKD : `Уважаемый клиент!
Заявка на возобновление подачи электроэнергии по вашему адресу сформирована.
Для возобновления подачи электроэнергии, Вам необходимо произвести оплату расходов по введению ограничения/приостановлению и возобновлению подачи электроэнергии пройдя по ссылке: https://www.mosenergosbyt.ru/individuals/kak-oplatit-schyet/payments-extra9.php
      
ВНИМАНИЕ!
Оплата производится строго на номер счета указанный в приложенной квитанции № С – 843-*********-*-**
Оплата произведенная по ЛС электроэнергии не учитывается в счет оплаты услуги по введению ограничения/приостановлению и возобновлению подачи электроэнергии.

После оплаты квитанции счета Вам необходимо направить на электронный адрес vkl-MKD@mosenergosbyt.ru  следующую информацию:
1. Копию квитанции об оплате счета, направленного в Ваш адрес.
2. Адрес, по которому оформлена заявка.

Внимание! АО «Мосэнергосбыт» не имеет возможности получавать обращения с зарубежных почтовых серверов/сервисов, таких как: Gmail.com, Outlook.com, iCloud.com, Yahoo.com и т.п. При отправке квитанции на такие электронные адреса доставка также не будет осуществлена.

Почтовый ящик vkl-MKD@mosenergosbyt.ru  предназначен только для получения АО «Мосэнергосбыт» информации от потребителя-должника об осуществлении оплаты по компенсации расходов по отключению/возобновлению подачи электроснабжения бытовым потребителям, после погашения задолженности.`,
      IGD_asumb : `Уважаемый клиент,
Заявка на возобновления подачи электроэнергии по вашему адресу сформирована!
Для возобновления подачи электроэнергии, Вам необходимо произвести оплату расходов по введению ограничения/приостановлению и возобновлению подачи электроэнергии пройдя по ссылке: https://www.mosenergosbyt.ru/individuals/kak-oplatit-schyet/payments-extra9.php
Далее нажать на логотип банка «ВБРР», в поле «Номер счета» вписать номер счета из квитанции за оказание услуги № С – 843-*********-*-** ( указанного в направленной квитанции), указать сумму оплаты и адрес электронной почты.

ВНИМАНИЕ!
Оплата производится строго на номер счета указанный в приложенной квитанции № С – 843-*********-*-**
Оплата произведенная по ЛС электроэнергии не учитывается в счет оплаты услуги по введению ограничения/приостановлению и возобновлению подачи электроэнергии.

Для подтверждения оплаты счета Вам необходимо направить на электронный адрес vkl-IGD@mosenergosbyt.ru следующую информацию:
1. Копию квитанции об оплате счета, направленного в Ваш адрес.
2. Адрес, по которому оформлена заявка.

Внимание! АО «Мосэнергосбыт» не имеет возможности получавать обращения с зарубежных почтовых серверов/сервисов, таких как: Gmail.com, Outlook.com, iCloud.com, Yahoo.com и т.п. При отправке квитанции на такие электронные адреса доставка также не будет осуществлена.

Обращаем Ваше внимание, что адрес электронной почты vkl-IGD@mosenergosbyt.ru предназначен только для получения АО «Мосэнергосбыт» информации от потребителя-должника об осуществлении оплаты по компенсации расходов по отключению/возобновлению подачи электроснабжения бытовым потребителям, после погашения задолженности.`,
      IGD : `Уважаемый клиент,
Заявка на возобновления подачи электроэнергии по вашему адресу сформирована!
Для возобновления подачи электроэнергии, Вам необходимо произвести оплату расходов по введению ограничения/приостановлению и возобновлению подачи электроэнергии пройдя по ссылке: https://www.mosenergosbyt.ru/individuals/kak-oplatit-schyet/payments-extra9.php
Далее нажать на логотип банка «ВБРР», в поле «Номер счета» вписать номер счета из квитанции за оказание услуги № С – 842-*********-*-** ( указанного в направленной квитанции), указать сумму оплаты и адрес электронной почты.

ВНИМАНИЕ!
Оплата производится строго на номер счета указанный в приложенной квитанции № С – 842-*********-*-**
Оплата произведенная по ЛС электроэнергии не учитывается в счет оплаты услуги по введению ограничения/приостановлению и возобновлению подачи электроэнергии.

Для подтверждения оплаты счета Вам необходимо направить на электронный адрес vkl-IGD@mosenergosbyt.ru следующую информацию:
1. Копию квитанции об оплате счета, направленного в Ваш адрес.
2. Адрес, по которому оформлена заявка.

Внимание! АО «Мосэнергосбыт» не имеет возможности получавать обращения с зарубежных почтовых серверов/сервисов, таких как: Gmail.com, Outlook.com, iCloud.com, Yahoo.com и т.п. При отправке квитанции на такие электронные адреса доставка также не будет осуществлена.

Почтовый ящик vkl-IGD@mosenergosbyt.ru предназначен только для получения АО «Мосэнергосбыт» информации от потребителя-должника об осуществлении оплаты по компенсации расходов по отключению/возобновлению подачи электроснабжения бытовым потребителям, после погашения задолженности.`,
      PD : `Добрый день!
Уважаемый клиент, во вложении квитанция по ЛС ххххх.
Благодарим за обращение в АО «Мосэнергосбыт».`,
      Akt : `Добрый день!
Уважаемый клиент, акт сверки по ЛС ххх за период с ХХ по ХХ во вложении. 
Благодарим за обращение в АО «Мосэнергосбыт»`,
      TextTemplates: `Восстановление электроэнергии | Квитанция АО Мосэнергосбыт | Акт сверки АО Мосэнергосбыт`
    };

    // Добавить новую функцию для копирования текста
    function copyTemplate(index) {
      const templates = send_mail_arr['TextTemplates'].split(' | ');
      if (index >= 0 && index < templates.length) {
        navigator.clipboard.writeText(templates[index]);
        // Визуальная обратная связь
        const elements = document.querySelectorAll('.text-template');
        elements[index].style.fontWeight = 'bold';
        setTimeout(() => {
          elements[index].style.fontWeight = 'normal';
        }, 500);
      }
    }

    function send_mail(arg) {
      navigator.clipboard.writeText(send_mail_arr[arg])
    }
	//Письма


// Функции для вкладки "Жалоба на отключение ЭЭ"
let selectedComplaintType = '';
let selectedConfirmationType = '';

function selectComplaintType(type) {
    selectedComplaintType = type;
    const themeText = document.getElementById('themeText');
    themeText.textContent = type;
    document.getElementById('selectedTheme').style.display = 'block';
    
    // Сбрасываем подтверждение при смене типа жалобы
    selectedConfirmationType = '';
    document.querySelectorAll('#confirmationTypeGroup button').forEach(btn => {
        btn.classList.remove('active');
    });
    
    if (type === 'Ошибочное отключение') {
        document.getElementById('confirmationTypeGroup').style.display = 'none';
        document.getElementById('emailGroup').style.display = 'none';
        document.getElementById('paymentDateGroup').style.display = 'none';
        document.getElementById('complaintDateGroup').style.display = 'none';
    } else {
        document.getElementById('confirmationTypeGroup').style.display = 'block';
        document.getElementById('complaintDateGroup').style.display = 'block';
    }
}

// Новая функция для копирования темы письма
function copyThemeText() {
    const themeText = document.getElementById('themeText').textContent;
    if (themeText) {
        navigator.clipboard.writeText(themeText).then(() => {
            // Визуальная обратная связь
            const element = document.getElementById('themeText');
            element.style.fontWeight = 'bold';
            setTimeout(() => {
                element.style.fontWeight = 'normal';
            }, 500);
        });
    }
}

function selectConfirmationType(type) {
    selectedConfirmationType = type;
    document.querySelectorAll('#confirmationTypeGroup button').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    if (type === 'Подтвердил через почту') {
        document.getElementById('emailGroup').style.display = 'block';
        document.getElementById('paymentDateGroup').style.display = 'block';
    } else {
        document.getElementById('emailGroup').style.display = 'none';
        document.getElementById('paymentDateGroup').style.display = 'none';
    }
}

function syncPaymentDate(dateValue) {
    document.getElementById('paymentDate').value = dateValue;
}

function copyComplaint() {
    const phone = document.getElementById('complaintPhone').value;
    let text = '';
    
    if (!phone) {
        alert('Пожалуйста, укажите телефон для связи');
        return;
    }
    
    if (selectedComplaintType === 'Ошибочное отключение') {
        text = `Со слов клиента, отключили э/э. Задолженности - нет, в графике на ограничение ЛС нет. Тел. для связи ${phone}`;
    } else {
        const complaintDate = formatDisplayDate(document.getElementById('complaintDate').value);
        
        if (!complaintDate) {
            alert('Пожалуйста, укажите дату оплаты');
            return;
        }
        
        if (selectedConfirmationType === 'Подтверждено в КО') {
            text = `э/э оплачена ${complaintDate}, подтверждение оплаты было в КО, тел. для связи ${phone}`;
        } else if (selectedConfirmationType === 'Подтвердил через почту') {
            const paymentDate = formatDisplayDate(document.getElementById('paymentDate').value);
            const email = document.getElementById('complaintEmail').value;
            
            if (!email) {
                alert('Пожалуйста, укажите email');
                return;
            }
            
            text = `э/э оплачена ${complaintDate}, направлен чек ${paymentDate} с эл. почты ${email}, тел. для связи ${phone}`;
        } else {
            alert('Пожалуйста, выберите тип подтверждения');
            return;
        }
    }
    
    navigator.clipboard.writeText(text).then(() => {
        alert('Текст скопирован в буфер обмена!');
    });
}

// Вспомогательная функция для форматирования даты
function formatDisplayDate(dateString) {
    if (!dateString) return '';
    const parts = dateString.split('-');
    return `${parts[2]}.${parts[1]}.${parts[0]}`;
}

// Инициализация при загрузке
document.addEventListener('DOMContentLoaded', function() {
    // Установка дат по умолчанию
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('complaintDate').value = today;
    document.getElementById('paymentDate').value = today;
    
    const oneMonthAgo = new Date();
    oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
    document.getElementById('contractDate').value = oneMonthAgo.toISOString().split('T')[0];
});

// Функции для вкладки "Жалоба на сроки заключения договора"
let selectedContractType = '';

function selectContractType(type) {
    selectedContractType = type;
    if (type === 'Подача в ЛКК') {
        document.getElementById('requestNumberGroup').style.display = 'block';
        document.getElementById('officeAddressGroup').style.display = 'none';
    } else {
        document.getElementById('requestNumberGroup').style.display = 'none';
        document.getElementById('officeAddressGroup').style.display = 'block';
    }
}

function copyContractComplaint() {
    const date = formatDisplayDate(document.getElementById('contractDate').value);
    const clientNumber = document.getElementById('clientNumber').value;
    let text = '';
    
    if (selectedContractType === 'Подача в ЛКК') {
        const requestNumber = document.getElementById('requestNumber').value;
        text = `${date} через ЛКК оформлена услуга Оформление заявки на заключение договора с физ. лицом № ${requestNumber}. 30 дней истекли, договор не заключен, ЛС не присвоен. Просьба посодействовать в решении вопроса, дать обратную связь клиенту, присвоить ЛС. Номер клиента: ${clientNumber}`;
    } else {
        const officeAddress = document.getElementById('officeAddress').value;
        text = `${date} в КО ${officeAddress} клиент подавал заявку на заключение договора. 30 дней истекли, договор не заключен, ЛС не присвоен. Просьба посодействовать в решении вопроса, дать обратную связь клиенту, присвоить ЛС. Номер клиента: ${clientNumber}`;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        alert('Текст скопирован в буфер обмена!');
    });
}

// Вспомогательная функция для форматирования даты
function formatDisplayDate(dateString) {
    if (!dateString) return '';
    const parts = dateString.split('-');
    return `${parts[2]}.${parts[1]}.${parts[0]}`;
}

// Инициализация при загрузке
document.addEventListener('DOMContentLoaded', function() {
    // Установка дат по умолчанию
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('complaintDate').value = today;
    document.getElementById('paymentDate').value = today;
    
    const oneMonthAgo = new Date();
    oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
    document.getElementById('contractDate').value = oneMonthAgo.toISOString().split('T')[0];
    
    // Синхронизация дат оплаты
    document.getElementById('complaintDate').addEventListener('change', function() {
        document.getElementById('paymentDate').value = this.value;
    });
});

// Остальные существующие функции (fnCopy1, fnCopy2, fnCopy3, rekviz1, rekviz2, send_mail и т.д.)
// ... оставьте без изменений ...


    // Расчет new
function nr() {
    bloknot.value = ''
    const d1 = new Date(nrDate1.value.slice(6), nrDate1.value.slice(3, 5), nrDate1.value.slice(0, 2));
    const d2 = new Date(nrDate2.value.slice(6), nrDate2.value.slice(3, 5), nrDate2.value.slice(0, 2));
    const diffInMs = Math.abs(d2 - d1);
    const msInDay = 1000 * 60 * 60 * 24;
    const dp = Math.floor(diffInMs / msInDay);
    const drT1 = (nr1T1.value - nrT1.value) / dp
    const drT2 = (nr1T2.value - nrT2.value) / dp
    const drT3 = (nr1T3.value - nrT3.value) / dp
    $('.nrItog').each( function () {
      const d3 = $(this).val()
      if (d3 != '') {
      const CurDate = new Date(d3.slice(6), d3.slice(3, 5), d3.slice(0, 2));
      const diffInMs1 = Math.abs(CurDate - d1);
      const dp1 = Math.floor(diffInMs1 / msInDay)
      console.log(drT1) //для отладки
      console.log(dp1) //для отладки
      const itogT1 = Math.floor(drT1 * dp1 + Number(nrT1.value))
      const itogT2 = Math.floor(drT2 * dp1 + Number(nrT2.value))
      const itogT3 = Math.floor(drT3 * dp1 + Number(nrT3.value))
      if (itogT2 == '') {
       bloknot.value += `Клиент ошибочно передал показания ${d3} То xxxx ; Корректировочные показания на ${d3} То ${itogT1} ;
`
      }
     else if (itogT3 == '') {
       bloknot.value += `Клиент ошибочно передал показания ${d3} Т1 xxxx ; Т2 xxxx ; Корректировочные показания на ${d3} Т1 ${itogT1} ; Т2 ${itogT2} ;
`
     }
      else {
       bloknot.value += `Клиент ошибочно передал показания ${d3} Т1 xxxx ; Т2 xxxx ; Т3 xxxx ; Корректировочные показания на ${d3} Т1 ${itogT1} ; Т2 ${itogT2} ; Т3 ${itogT3} ;
`
      }
      $('#bloknot').attr('style', 'width: 1000px; height: 250px')
      }
    })
	
	// Новая функция для копирования текстовых шаблонов
      function copyTemplate(index) {
        const templates = send_mail_arr['TextTemplates'].split(' | ');
        if (index >= 0 && index < templates.length) {
          navigator.clipboard.writeText(templates[index]);
          // Визуальная обратная связь
          const elements = document.querySelectorAll('.text-template');
          elements[index].style.fontWeight = 'bold';
          setTimeout(() => {
            elements[index].style.fontWeight = 'normal';
          }, 500);
        }
      }
}
    // Расчет new

  </script>
  
</html>
