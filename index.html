<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Шаблоны МЭС</title>
	
	  <!-- Добавлена иконка сайта Мосэнергосбыт -->
    <link rel="icon" href="https://www.mosenergosbyt.ru/favicon.ico" type="image/x-icon">
	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
.btn-link {
            width: 100%;
            text-align: left;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50 !important;
            text-decoration: none !important;
            border-radius: 8px;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
            border-left: 4px solid transparent;
        }
        
        .btn-link:hover {
            background-color: #e9ecef;
            border-left: 4px solid #3498db;
        }
        
        /* Исправленный стиль для paymentDateGroup */
        #paymentDateGroup {
            display: none;
        }
    </style>

<!--Стиль тем письма-->


<style>
/* Центрирование всего блока */
.email-templates-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 20px 0;
}

/* Стиль для строки с темой писем */
.template-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    font-size: 15px;
    color: #495057;
}

/* Стиль для кнопок тем писем */
.template-option {
    padding: 6px 12px;
    margin: 0 5px;
    border-radius: 16px;
    background: #f8f9fa;
    color: #212529;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid #dee2e6;
    font-size: 14px;
}

.template-option:hover {
    background: #e9ecef;
    border-color: #adb5bd;
    transform: translateY(-1px);
}

.template-option.active {
    background: #007bff;
    color: white;
    border-color: #007bff;
}

.template-option.copied {
    background: #28a745 !important;
    color: white !important;
    border-color: #28a745 !important;
}

/* Разделитель */
.template-divider {
    color: #adb5bd;
    margin: 0 5px;
}

/* Стиль для кнопок действий */
.action-btn {
    padding: 8px 16px;
    margin: 5px;
    border-radius: 6px;
    border: none;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    min-width: 120px;
}

.action-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Цвета кнопок */
.btn-mkd { background: #6c757d; color: white; }
.btn-igd-asumb { background: #28a745; color: white; }
.btn-igd { background: #fd7e14; color: white; }
.btn-pd { background: #007bff; color: white; }
.btn-akt { background: #17a2b8; color: white; }

/* Контейнер для кнопок */
.actions-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 10px;
}
</style>




<!--Стиль кнопок-->

<style>
.action-btn {
    position: relative;
    padding: 15px 20px 15px 60px;
    margin: 0 10px 15px 0;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    font-size: 15px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: left;
    color: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    overflow: hidden;
}

.action-btn::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 40px;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
}

.action-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

/* Конкретные стили для каждой кнопки */
.btn-mkd {
    background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
}
.btn-mkd::before {
    content: '\f1ad';
    background: rgba(0,0,0,0.1);
}

.btn-igd-asumb {
    background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
}
.btn-igd-asumb::before {
    content: '\f015';
    background: rgba(0,0,0,0.1);
}

.btn-igd {
    background: linear-gradient(135deg, #fd7e14 0%, #e36209 100%);
}
.btn-igd::before {
    content: '\f7b2';
    background: rgba(0,0,0,0.1);
}

.btn-pd {
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
}
.btn-pd::before {
    content: '\f571';
    background: rgba(0,0,0,0.1);
}

.btn-akt {
    background: linear-gradient(135deg, #17a2b8 0%, #117a8b 100%);
}
.btn-akt::before {
    content: '\f46c';
    background: rgba(0,0,0,0.1);
}

.btn-badge {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 3px;
}

.change-log-content {
  display: none;
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  border: 1px solid #ddd;
  padding: 15px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  z-index: 1000;
  width: 300px;
  margin-top: 10px;
}

</style>

<style>
.mobile-block {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    z-index: 9999;
    text-align: center;
    padding: 50px 20px;
}

.mobile-block h2 {
    color: #dc3545;
    margin-bottom: 20px;
}

.mobile-block p {
    font-size: 18px;
    margin-bottom: 30px;
}

@media (max-width: 768px), (hover: none) and (pointer: coarse) {
    .mobile-block {
        display: block;
    }
    body {
        overflow: hidden;
    }
    #accordion, .email-templates-container {
        display: none;
    }
}
</style>

<div class="mobile-block">
    <h2>⚠️ Сайт не работает на мобильных устройствах</h2>
    <p>Пожалуйста, откройте сайт на компьютере или ноутбуке</p>
    <p>Данный инструмент предназначен для работы на ПК</p>
</div>


    <!-- bootstrap4 -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!-- bootstrap4 -->

 <style type="text/css">
  #bloknot {
    width: 150px; 
    position: fixed;
    z-index: 999;
    right: 0;
    transition: cubic-bezier(.61,1.95,.26,.95) .5s;
    display: none; /* Скрываем по умолчанию */
  }
  .text-template {
    cursor: pointer;
    color: #007bff;
    text-decoration: underline;
  }
  .text-template:hover {
    color: #0056b3;
    text-decoration: none;
  }
</style>
  </head>
  <body>
  
  <!--<style>
  body {
    background-image: url('https://krasnogorsk-adm.ru/netcat_files/3/1/Mosenergosbyt.png');
    background-repeat: no-repeat;
    background-size: cover;
  }
</style>
-->

<style>
#hideBloknotBtn {
  position: fixed;
  right: 20px;
  top: 100px;
  z-index: 1000;
  display: none;
}
</style>

<textarea class="form-control" rows="3" id="bloknot"></textarea>
<button onclick="document.getElementById('bloknot').style.display = 'none'" 
        class="btn btn-sm btn-secondary" id="hideBloknotBtn">
  <i class="fas fa-times"></i>
</button>

    <div id="accordion">
      <div class="card">
        <div class="card-header" id="headingOne">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Корректировки
            </button>
          </h5>
        </div>
        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
          <div class="container mt-3">
		  
		 

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Не согласен с показаниями "Сети", Сетевой участок Россети МР; Дата сети
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="sDate">; То
  <input type="text" style="width: 60px" maxlength="6" id="sT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="sT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="sT2"> ; Т3
  <input type="text" style="width: 60px" maxlength="6" id="sT3"> ;
    </span><span class="input-group-text">Дата кл 
  <input class="thisDate" oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="cDate">; То 
  <input type="text" style="width: 60px" maxlength="6" id="cT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="cT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="cT2"> ; Т3 
  <input type="text" style="width: 60px" maxlength="6" id="cT3"> ;
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="fnCopy1()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Клиент ошибочно передал показания
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="fDate">; То
  <input type="text" style="width: 60px" maxlength="6" id="fT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="fT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="fT2"> ; Т3
  <input type="text" style="width: 60px" maxlength="6" id="fT3"> ;
    </span><span class="input-group-text">Корректировочные показания на 
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="tDate">; То 
  <input type="text" style="width: 60px" maxlength="6" id="tT0"> ; Т1 
  <input type="text" style="width: 60px" maxlength="6" id="tT1"> ; Т2 
  <input type="text" style="width: 60px" maxlength="6" id="tT2"> ; Т3 
  <input type="text" style="width: 60px" maxlength="6" id="tT3"> ;
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="fnCopy2()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">
  <input oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="f1Date"> клиент ошибочно передал показания То-
  <input type="text" style="width: 60px" maxlength="6" id="f1T0">, Т1-
  <input type="text" style="width: 60px" maxlength="6" id="f1T1">, Т2-
  <input type="text" style="width: 60px" maxlength="6" id="f1T2">, Т3-
  <input type="text" style="width: 60px" maxlength="6" id="f1T3">, данные показания необходимо удалить.
    </span><span class="input-group-text">Корректные показания на 
  <input class="thisDate" oninput="formatDate(this)" type="text" maxlength="10" placeholder="ХХ.ХХ.ХХХХ" style="width: 90px" id="t1Date"> То-
  <input type="text" style="width: 60px" maxlength="6" id="t1T0">, Т1- 
  <input type="text" style="width: 60px" maxlength="6" id="t1T1">, Т2- 
  <input type="text" style="width: 60px" maxlength="6" id="t1T2">, Т3- 
  <input type="text" style="width: 60px" maxlength="6" id="t1T3">
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="fnCopy3()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
  <h5>Расчет new</h5>
   <div class="input-group">
    <span class="input-group-text">
  Показания на начало периода &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" id="nrDate1" placeholder="Дата" maxlength="10">, Т1-
  <input type="text" style="width: 60px" id="nrT1">, Т2-
  <input type="text" style="width: 60px" id="nrT2">, Т3-
  <input type="text" style="width: 60px" id="nrT3">
    </span><span class="input-group-text">Текущие показания &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" id="nrDate2" placeholder="Дата" maxlength="10">, Т1-
  <input type="text" style="width: 60px" id="nr1T1">, Т2-
  <input type="text" style="width: 60px" id="nr1T2">, Т3-
  <input type="text" style="width: 60px" id="nr1T3">
    </span><span class="input-group-text">Дата показаний, которые нужно корректировать &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
  <input oninput="formatDate(this)" onkeydown="return dateInputFilter(this, event)" type="text" style="width: 90px" class="nrItog" placeholder="Дата" maxlength="10"> &nbsp;
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="nr()">Рассчитать</button>
</div>

</div>

    </div>
  </div>

  <div class="card">
    <div class="card-header" id="headingTwo">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Жалоба на сроки доставки ПД
        </button>
      </h5>
    </div>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
      <div class="card-body">
<div class="container-fluid">
  
<table class="table table-striped">
  <thead>
  </thead>
  <tbody>
<script type="text/javascript">
  const month_1 = ["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];
  const d = new Date();
  if (d.getMonth() == 0) {var name = month_1[d.getMonth()+11]} else {var name = month_1[d.getMonth()-1]}
    document.write(`
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). В ЛС адрес клиента указан верно (сотрудник должен сверить адрес доставки ПД);</td>
    </tr>
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). В ЛС адрес клиента указан верно. Со слов клиента квитанции за ${name} (месяц) не получил весь дом.</td>
    </tr>
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). Альтернативный адрес сверен.</td>
    </tr>
    <tr>
      <td scope="row">Клиент не получил квитанцию за ${name} (месяц). В ЛС адрес клиента указан верно. Квитанции разбросаны по всей улице (дому).</td>
    </tr>
      `)
</script>
  </tbody>
</table>

</div>

      </div>
    </div>
  </div>
  <div class="card">
    <div class="card-header" id="headingThree">
      <h5 class="mb-0">
        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          Заявка на изменение реквизитов
        </button>
      </h5>
    </div>
    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
      <div class="card-body">

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Клиенту поступают звонки/смс/ E-mail на телефон 
    <input type="text" style="width: 60px" id="phone_1"> /на E-mail 
    <input type="text" style="width: 60px" id="mail_1">  о задолженности по ЛС
    <input type="text" style="width: 60px" id="ls_1" onchange="ls_11.value = this.value"> . Клиент не имеет отношение к ЛС 
    <input type="text" style="width: 60px" id="ls_11" disabled> . 
    </span><span class="input-group-text">Дата информирования 
    <input type="date" id="date_1"/>. Автообзвон/ E-mail информирование/Росдолг, ручной обзвон/смс-оповещение.
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="rekviz1()">Скопировать</button>
</div>

<div class="alert alert-primary center" role="alert">
<div class="input-group">
    <span class="input-group-text">Клиенту на E-mail 
    <input type="text" style="width: 60px" id="mail_2" onchange="mail_22.value = this.value"> поступила электронная квитанция по ЛС 
    <input type="text" style="width: 60px" id="ls_2"> . Клиент отказывается от получения эл. счетов. Адрес электронной почты 
    <input type="text" style="width: 60px" id="mail_22" disabled> необходимо удалить из биллинга
    </span>
</div>
 <button type="button" class="btn btn-primary mt-2" onclick="rekviz2()">Скопировать</button>
</div>

      </div>
    </div>
  </div>
</div>

  <!-- Новая вкладка "Жалоба на отключение ЭЭ" -->
      <div class="card">
        <div class="card-header" id="headingFour">
          <h5 class="mb-0">
            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
              Жалоба на отключение ЭЭ
            </button>
          </h5>
        </div>
        <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
          <div class="card-body">
            <div class="container mt-3">
              <div class="alert alert-primary center" role="alert">
                <div class="form-group">
                  <label>Тип жалобы:</label>
                  <div class="btn-group w-100">
                    <button type="button" class="btn btn-outline-primary" onclick="selectComplaintType('Ошибочное отключение')">Ошибочное отключение</button>
                    <button type="button" class="btn btn-outline-primary" onclick="selectComplaintType('Нарушен срок возобновления')">Нарушен срок возобновления</button>
                  </div>
                </div>

                <div class="form-group mt-3" id="selectedTheme" style="display: none;">
                  <label>Тема письма:</label>
                  <span id="themeText" class="text-template" onclick="copyThemeText()"></span>
                </div>

                <div class="form-group mt-3" id="confirmationTypeGroup" style="display: none;">
                  <label>Подтверждение:</label>
                  <div class="btn-group w-100">
                    <button type="button" class="btn btn-outline-secondary" onclick="selectConfirmationType('Подтвердил через почту')">Подтвердил через почту</button>
                    <button type="button" class="btn btn-outline-secondary" onclick="selectConfirmationType('Подтверждено в КО')">Подтверждено в КО</button>
                  </div>
                </div>

               <div class="form-group mt-3" id="complaintDateGroup" style="display: none;">
                  <label for="complaintDate">Дата оплаты:</label>
                  <input type="date" class="form-control" id="complaintDate" onchange="syncPaymentDate(this.value)">
                </div>

                <div class="form-group">
                  <label for="complaintPhone">Телефон для связи:</label>
                  <input type="text" class="form-control" id="complaintPhone" placeholder="Номер телефона">
                </div>

                <div class="form-group" id="emailGroup" style="display: none;">
                  <label for="complaintEmail">Электронная почта:</label>
                  <input type="email" class="form-control" id="complaintEmail" placeholder="Email">
                </div>
                <div class="form-group" id="paymentDateGroup" style="display: none;">
                  <label for="paymentDate">Дата отправки чека:</label>
                  <input type="date" class="form-control" id="paymentDate">
                </div>

                <button type="button" class="btn btn-primary mt-2" onclick="copyComplaint()">Скопировать</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
	
	 <!-- Новая вкладка "Жалоба на сроки заключения договора" -->
      <div class="card">
        <div class="card-header" id="headingFive">
          <h5 class="mb-0">
            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
              Жалоба на сроки заключения договора
            </button>
          </h5>
        </div>
        <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
          <div class="card-body">
            <div class="container mt-3">
              <div class="alert alert-primary center" role="alert">
                <div class="form-group">
                  <label>Тип подачи:</label>
                  <div class="btn-group w-100">
                    <button type="button" class="btn btn-outline-primary" onclick="selectContractType('Подача в ЛКК')">Подача в ЛКК</button>
                    <button type="button" class="btn btn-outline-primary" onclick="selectContractType('Подача в КО')">Подача в КО</button>
                  </div>
                </div>

                <div class="form-group mt-3">
                  <label for="contractDate">Дата обращения:</label>
                  <input type="date" class="form-control" id="contractDate">
                </div>

                <div class="form-group" id="requestNumberGroup" style="display: none;">
                  <label for="requestNumber">Номер заявки:</label>
                  <input type="text" class="form-control" id="requestNumber" placeholder="Номер заявки" maxlength="20">
                </div>

                <div class="form-group">
                  <label for="clientNumber">Номер клиента:</label>
                  <input type="text" class="form-control" id="clientNumber" placeholder="Номер клиента" maxlength="15">
                </div>

                <div class="form-group" id="officeAddressGroup" style="display: none;">
                  <label for="officeAddress">Адрес/название КО:</label>
                  <input type="text" class="form-control" id="officeAddress" placeholder="Адрес или название КО">
                </div>

                <button type="button" class="btn btn-primary mt-2" onclick="copyContractComplaint()">Скопировать</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
	
	<!-- Оплата БК -->
<div class="card">
  <div class="card-header" id="headingSix">
    <h5 class="mb-0">
      <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
        Оплата по БК
      </button>
    </h5>
  </div>
  <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#accordion">
    <div class="card-body">
      <div class="container mt-3">
        <div class="alert alert-primary center" role="alert">
          <div class="input-group">
            <span class="input-group-text">ФИО (на русском):
              <input type="text" style="width: 200px" id="bkName" placeholder="Введите ФИО" oninput="transliterateBKName()">
            </span>
            <span class="input-group-text" id="bkLatinGroup" style="display:none">
              ФИО (на латинице): <span id="bkLatinName" class="font-weight-bold ml-1"></span>
              <button type="button" class="btn btn-sm btn-outline-secondary ml-2" onclick="copyBKName()">
                <i class="fas fa-copy"></i>
              </button>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
	
<div class="container-fluid email-templates-container">
    <div class="template-header">
        <span class="mr-2">Темы писем:</span>
        <span class="template-option" onclick="copyTemplate(0)">Восстановление электроэнергии</span>
        <span class="template-divider">|</span>
        <span class="template-option" onclick="copyTemplate(1)">Квитанция АО Мосэнергосбыт</span>
        <span class="template-divider">|</span>
        <span class="template-option" onclick="copyTemplate(2)">Акт сверки АО Мосэнергосбыт</span>
    </div>

    <div class="actions-container">
        <button type="button" class="action-btn btn-mkd" onclick="send_mail('MKD')">Восстановление МКД</button>
        <button type="button" class="action-btn btn-igd-asumb" onclick="send_mail('IGD_asumb')">ИЖД АСУМБ</button>
        <button type="button" class="action-btn btn-igd" onclick="send_mail('IGD')">Восстановление ИЖД</button>
        <button type="button" class="action-btn btn-pd" onclick="send_mail('PD')">Квитанция</button>
        <button type="button" class="action-btn btn-akt" onclick="send_mail('Akt')">Акт сверки</button>
    </div>
</div>
      

    <script type="text/javascript">

// Основные функции для работы с датами
function formatDate(input) {
    let value = input.value.replace(/\./g, '');
    
    if (value.length > 8) {
        value = value.slice(0, 8);
    }
    
    if (value.length > 4) {
        value = value.slice(0, 2) + '.' + value.slice(2, 4) + '.' + value.slice(4);
    } else if (value.length > 2) {
        value = value.slice(0, 2) + '.' + value.slice(2);
    }
    
    input.value = value;
}

function dateInputFilter(input, event) {
    const key = event.key;
    const isDigit = /^\d$/.test(key);
    const isControl = ['Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 'Tab'].includes(key);
    
    if (!isDigit && !isControl) {
        event.preventDefault();
        return false;
    }
    return true;
}

// Функции для корректировок
function fnCopy1() {
    const text = `Не согласен с показаниями "Сети", Сетевой участок Россети МР; Дата сети ${document.getElementById('sDate').value}; То ${document.getElementById('sT0').value} ; Т1 ${document.getElementById('sT1').value} ; Т2 ${document.getElementById('sT2').value} ; Т3 ${document.getElementById('sT3').value} ; Дата кл ${document.getElementById('cDate').value}; То ${document.getElementById('cT0').value} ; Т1 ${document.getElementById('cT1').value} ; Т2 ${document.getElementById('cT2').value} ; Т3 ${document.getElementById('cT3').value} ;`;
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст скопирован!');
    });
}

function fnCopy2() {
    const fDate = document.getElementById('fDate').value;
    const fT0 = document.getElementById('fT0').value;
    const fT1 = document.getElementById('fT1').value;
    const fT2 = document.getElementById('fT2').value;
    const fT3 = document.getElementById('fT3').value;
    const tDate = document.getElementById('tDate').value;
    const tT0 = document.getElementById('tT0').value;
    const tT1 = document.getElementById('tT1').value;
    const tT2 = document.getElementById('tT2').value;
    const tT3 = document.getElementById('tT3').value;
    
    let text;
    if (!fT3 && !fT0) {
        text = `Клиент ошибочно передал показания ${fDate} Т1 ${fT1} ; Т2 ${fT2} ; Корректировочные показания на ${tDate} Т1 ${tT1} ; Т2 ${tT2} ;`;
    } else if (!fT0) {
        text = `Клиент ошибочно передал показания ${fDate} Т1 ${fT1} ; Т2 ${fT2} ; Т3 ${fT3} ; Корректировочные показания на ${tDate} Т1 ${tT1} ; Т2 ${tT2} ; Т3 ${tT3} ;`;
    } else {
        text = `Клиент ошибочно передал показания ${fDate} То ${fT0} ; Корректировочные показания на ${tDate} То ${tT0} ;`;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст скопирован!');
    });
}

function fnCopy3() {
    const f1Date = document.getElementById('f1Date').value;
    const f1T0 = document.getElementById('f1T0').value;
    const f1T1 = document.getElementById('f1T1').value;
    const f1T2 = document.getElementById('f1T2').value;
    const f1T3 = document.getElementById('f1T3').value;
    const t1Date = document.getElementById('t1Date').value;
    const t1T0 = document.getElementById('t1T0').value;
    const t1T1 = document.getElementById('t1T1').value;
    const t1T2 = document.getElementById('t1T2').value;
    const t1T3 = document.getElementById('t1T3').value;
    
    let text;
    if (!f1T3 && !f1T0) {
        text = `${f1Date} клиент ошибочно передал показания Т1-${f1T1}, Т2-${f1T2}, данные показания необходимо удалить. Корректные показания на ${t1Date}, Т1-${t1T1}, Т2-${t1T2}.`;
    } else if (!f1T0) {
        text = `${f1Date} клиент ошибочно передал показания Т1-${f1T1}, Т2-${f1T2}, Т3-${f1T3}, данные показания необходимо удалить. Корректные показания на ${t1Date}, Т1-${t1T1}, Т2-${t1T2}, Т3-${t1T3}.`;
    } else {
        text = `${f1Date} клиент ошибочно передал показания То-${f1T0}, данные показания необходимо удалить. Корректные показания на ${t1Date}, То-${t1T0}.`;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст скопирован!');
    });
}

// Функции для изменения реквизитов
function rekviz1() {
    const phone = document.getElementById('phone_1').value;
    const mail = document.getElementById('mail_1').value;
    const ls = document.getElementById('ls_1').value;
    const date = document.getElementById('date_1').value;
    
    let text;
    if (!phone) {
        text = `Клиенту поступают E-mail на E-mail ${mail} о задолженности по ЛС ${ls}. Клиент не имеет отношение к ЛС ${ls}. Дата информирования ${date}. E-mail информирование.`;
    } else if (!mail) {
        text = `Клиенту поступают звонки/смс на телефон ${phone} о задолженности по ЛС ${ls}. Клиент не имеет отношение к ЛС ${ls}. Дата информирования ${date}. Автообзвон/Росдолг, ручной обзвон/смс-оповещение.`;
    } else {
        text = `Клиенту поступают звонки/смс/ E-mail на телефон ${phone} /на E-mail ${mail} о задолженности по ЛС ${ls}. Клиент не имеет отношение к ЛС ${ls}. Дата информирования ${date}. Автообзвон/ E-mail информирование/Росдолг, ручной обзвон/смс-оповещение.`;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст скопирован!');
    });
}

function rekviz2() {
    const mail = document.getElementById('mail_2').value;
    const ls = document.getElementById('ls_2').value;
    
    const text = `Клиенту на E-mail ${mail} поступила электронная квитанция по ЛС ${ls}. Клиент отказывается от получения эл. счетов. Адрес электронной почты ${mail} необходимо удалить из биллинга`;
    
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст скопирован!');
    });
}

// Функции для отправки писем
const send_mail_arr = {
    MKD: `Уважаемый клиент!
Заявка на возобновление подачи электроэнергии по вашему адресу сформирована.
Для возобновления подачи электроэнергии, Вам необходимо произвести оплату расходов по введению ограничения/приостановлению и возобновлению подачи электроэнергии пройдя по ссылке: https://www.mosenergosbyt.ru/individuals/kak-oplatit-schyet/payments-extra9.php
      
ВНИМАНИЕ!
Оплата производится строго на номер счета указанный в приложенной квитанции № С – 843-*********-*-**
Оплата произведенная по ЛС электроэнергии не учитывается в счет оплаты услуги по введению ограничения/приостановлению и возобновлению подачи электроэнергии.

После оплаты квитанции счета Вам необходимо направить на электронный адрес vkl-MKD@mosenergosbyt.ru следующую информацию:
1. Копию квитанции об оплате счета, направленного в Ваш адрес.
2. Адрес, по которому оформлена заявка.

Внимание! АО «Мосэнергосбыт» не имеет возможности получавать обращения с зарубежных почтовых серверов/сервисов, таких как: Gmail.com, Outlook.com, iCloud.com, Yahoo.com и т.п. При отправке квитанции на такие электронные адреса доставка также не будет осуществлена.

Почтовый ящик vkl-MKD@mosenergosbyt.ru предназначен только для получения АО «Мосэнергосбыт» информации от потребителя-должника об осуществлении оплаты по компенсации расходов по отключению/возобновлению подачи электроснабжения бытовым потребителям, после погашения задолженности.`,

    IGD_asumb: `Уважаемый клиент,
Заявка на возобновления подачи электроэнергии по вашему адресу сформирована!
Для возобновления подачи электроэнергии, Вам необходимо произвести оплату расходов по введению ограничения/приостановлению и возобновлению подачи электроэнергии пройдя по ссылке: https://www.mosenergosbyt.ru/individuals/kak-oplatit-schyet/payments-extra9.php
Далее нажать на логотип банка «ВБРР», в поле «Номер счета» вписать номер счета из квитанции за оказание услуги № С – 843-*********-*-** (указанного в направленной квитанции), указать сумму оплаты и адрес электронной почты.

ВНИМАНИЕ!
Оплата производится строго на номер счета указанный в приложенной квитанции № С – 843-*********-*-**
Оплата произведенная по ЛС электроэнергии не учитывается в счет оплаты услуги по введению ограничения/приостановлению и возобновлению подачи электроэнергии.

Для подтверждения оплаты счета Вам необходимо направить на электронный адрес vkl-IGD@mosenergosbyt.ru следующую информацию:
1. Копию квитанции об оплате счета, направленного в Ваш адрес.
2. Адрес, по которому оформлена заявка.

Внимание! АО «Мосэнергосбыт» не имеет возможности получавать обращения с зарубежных почтовых серверов/сервисов, таких как: Gmail.com, Outlook.com, iCloud.com, Yahoo.com и т.п. При отправке квитанции на такие электронные адреса доставка также не будет осуществлена.

Обращаем Ваше внимание, что адрес электронной почты vkl-IGD@mosenergosbyt.ru предназначен только для получения АО «Мосэнергосбыт» информации от потребителя-должника об осуществлении оплаты по компенсации расходов по отключению/возобновлению подачи электроснабжения бытовым потребителям, после погашения задолженности.`,

    IGD: `Уважаемый клиент,
Заявка на возобновления подачи электроэнергии по вашему адресу сформирована!
Для возобновления подачи электроэнергии, Вам необходимо произвести оплату расходов по введению ограничения/приостановлению и возобновлению подачи электроэнергии пройдя по ссылке: https://www.mosenergosbyt.ru/individuals/kak-oplatit-schyet/payments-extra9.php
Далее нажать на логотип банка «ВБРР», в поле «Номер счета» вписать номер счета из квитанции за оказание услуги № С – 842-*********-*-** (указанного в направленной квитанции), указать сумму оплаты и адрес электронной почты.

ВНИМАНИЕ!
Оплата производится строго на номер счета указанный в приложенной квитанции № С – 842-*********-*-**
Оплата произведенная по ЛС электроэнергии не учитывается в счет оплаты услуги по введению ограничения/приостановлению и возобновлению подачи электроэнергии.

Для подтверждения оплаты счета Вам необходимо направить на электронный адрес vkl-IGD@mosenergosbyt.ru следующую информацию:
1. Копию квитанции об оплате счета, направленного в Ваш адрес.
2. Адрес, по которому оформлена заявка.

Внимание! АО «Мосэнергосбыт» не имеет возможности получавать обращения с зарубежных почтовых серверов/сервисов, таких как: Gmail.com, Outlook.com, iCloud.com, Yahoo.com и т.п. При отправке квитанции на такие электронные адреса доставка также не будет осуществлена.

Почтовый ящик vkl-IGD@mosenergosbyt.ru предназначен только для получения АО «Мосэнергосбыт» информации от потребителя-должника об осуществлении оплаты по компенсации расходов по отключению/возобновлению подачи электроснабжения бытовым потребителям, после погашения задолженности.`,

    PD: `Добрый день!
Уважаемый клиент, во вложении квитанция по ЛС ххххх.
Благодарим за обращение в АО «Мосэнергосбыт».`,

    Akt: `Добрый день!
Уважаемый клиент, акт сверки по ЛС ххх за период с ХХ по ХХ во вложении. 
Благодарим за обращение в АО «Мосэнергосбыт»`,

    TextTemplates: `Восстановление электроэнергии | Квитанция АО Мосэнергосбыт | Акт сверки АО Мосэнергосбыт`
};

function send_mail(arg) {
    navigator.clipboard.writeText(send_mail_arr[arg]).then(() => {
        showNotification('Текст письма скопирован!');
    });
}

function copyTemplate(index) {
    const templates = send_mail_arr['TextTemplates'].split(' | ');
    if (index >= 0 && index < templates.length) {
        navigator.clipboard.writeText(templates[index]).then(() => {
            // Визуальная обратная связь для кнопок тем
            const templateButtons = document.querySelectorAll('.template-option');
            templateButtons[index].style.fontWeight = 'bold';
            templateButtons[index].style.backgroundColor = '#007bff';
            templateButtons[index].style.color = 'white';
            
            setTimeout(() => {
                templateButtons[index].style.fontWeight = 'normal';
                templateButtons[index].style.backgroundColor = '#f8f9fa';
                templateButtons[index].style.color = '#212529';
            }, 1000);
            
            // Показываем уведомление
            showNotification('Тема скопирована: ' + templates[index]);
        }).catch(err => {
            showNotification('Ошибка копирования', 'error');
        });
    }
}

// Функции для жалобы на отключение ЭЭ
let selectedComplaintType = '';
let selectedConfirmationType = '';

function selectComplaintType(type) {
    selectedComplaintType = type;
    document.getElementById('themeText').textContent = type;
    document.getElementById('selectedTheme').style.display = 'block';
    
    selectedConfirmationType = '';
    document.querySelectorAll('#confirmationTypeGroup button').forEach(btn => {
        btn.classList.remove('active');
    });
    
    if (type === 'Ошибочное отключение') {
        document.getElementById('confirmationTypeGroup').style.display = 'none';
        document.getElementById('emailGroup').style.display = 'none';
        document.getElementById('paymentDateGroup').style.display = 'none';
        document.getElementById('complaintDateGroup').style.display = 'none';
    } else {
        document.getElementById('confirmationTypeGroup').style.display = 'block';
        document.getElementById('complaintDateGroup').style.display = 'block';
    }
}

function copyThemeText() {
    const themeText = document.getElementById('themeText').textContent;
    if (themeText) {
        navigator.clipboard.writeText(themeText).then(() => {
            const element = document.getElementById('themeText');
            element.style.fontWeight = 'bold';
            setTimeout(() => {
                element.style.fontWeight = 'normal';
            }, 500);
            showNotification('Тема скопирована!');
        });
    }
}

function selectConfirmationType(type) {
    selectedConfirmationType = type;
    document.querySelectorAll('#confirmationTypeGroup button').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    if (type === 'Подтвердил через почту') {
        document.getElementById('emailGroup').style.display = 'block';
        document.getElementById('paymentDateGroup').style.display = 'block';
    } else {
        document.getElementById('emailGroup').style.display = 'none';
        document.getElementById('paymentDateGroup').style.display = 'none';
    }
}

function syncPaymentDate(dateValue) {
    document.getElementById('paymentDate').value = dateValue;
}

function copyComplaint() {
    const phone = document.getElementById('complaintPhone').value;
    
    if (!phone) {
        showNotification('Пожалуйста, укажите телефон для связи', 'error');
        return;
    }
    
    let text = '';
    
    if (selectedComplaintType === 'Ошибочное отключение') {
        text = `Со слов клиента, отключили э/э. Задолженности - нет, в графике на ограничение ЛС нет. Тел. для связи ${phone}`;
    } else {
        const complaintDate = formatDisplayDate(document.getElementById('complaintDate').value);
        
        if (!complaintDate) {
            showNotification('Пожалуйста, укажите дату оплаты', 'error');
            return;
        }
        
        if (selectedConfirmationType === 'Подтверждено в КО') {
            text = `э/э оплачена ${complaintDate}, подтверждение оплаты было в КО, тел. для связи ${phone}`;
        } else if (selectedConfirmationType === 'Подтвердил через почту') {
            const paymentDate = formatDisplayDate(document.getElementById('paymentDate').value);
            const email = document.getElementById('complaintEmail').value;
            
            if (!email) {
                showNotification('Пожалуйста, укажите email', 'error');
                return;
            }
            
            text = `э/э оплачена ${complaintDate}, направлен чек ${paymentDate} с эл. почты ${email}, тел. для связи ${phone}`;
        } else {
            showNotification('Пожалуйста, выберите тип подтверждения', 'error');
            return;
        }
    }
    
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст жалобы скопирован!');
    });
}

// Функции для жалобы на сроки заключения договора
let selectedContractType = '';

function selectContractType(type) {
    selectedContractType = type;
    if (type === 'Подача в ЛКК') {
        document.getElementById('requestNumberGroup').style.display = 'block';
        document.getElementById('officeAddressGroup').style.display = 'none';
    } else {
        document.getElementById('requestNumberGroup').style.display = 'none';
        document.getElementById('officeAddressGroup').style.display = 'block';
    }
}

function copyContractComplaint() {
    const date = formatDisplayDate(document.getElementById('contractDate').value);
    const clientNumber = document.getElementById('clientNumber').value;
    
    if (!clientNumber) {
        showNotification('Пожалуйста, укажите номер клиента', 'error');
        return;
    }
    
    let text = '';
    
    if (selectedContractType === 'Подача в ЛКК') {
        const requestNumber = document.getElementById('requestNumber').value;
        if (!requestNumber) {
            showNotification('Пожалуйста, укажите номер заявки', 'error');
            return;
        }
        text = `${date} через ЛКК оформлена услуга Оформление заявки на заключение договора с физ. лицом № ${requestNumber}. 30 дней истекли, договор не заключен, ЛС не присвоен. Просьба посодействовать в решении вопроса, дать обратную связь клиенту, присвоить ЛС. Номер клиента: ${clientNumber}`;
    } else {
        const officeAddress = document.getElementById('officeAddress').value;
        if (!officeAddress) {
            showNotification('Пожалуйста, укажите адрес/название КО', 'error');
            return;
        }
        text = `${date} в КО ${officeAddress} клиент подавал заявку на заключение договора. 30 дней истекли, договор не заключен, ЛС не присвоен. Просьба посодействовать в решении вопроса, дать обратную связь клиенту, присвоить ЛС. Номер клиента: ${clientNumber}`;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Текст жалобы скопирован!');
    });
}

// Функции для оплаты БК
function transliterateBKName() {
    const russianName = document.getElementById('bkName').value.trim();
    const latinNameElement = document.getElementById('bkLatinName');
    const latinGroup = document.getElementById('bkLatinGroup');
    
    if (russianName) {
        const translitMap = {
            'а': 'a', 'б': 'b', 'в': 'v', 'г': 'g', 'д': 'd',
            'е': 'e', 'ё': 'e', 'ж': 'zh', 'з': 'z', 'и': 'i',
            'й': 'y', 'к': 'k', 'л': 'l', 'м': 'm', 'н': 'n',
            'о': 'o', 'п': 'p', 'р': 'r', 'с': 's', 'т': 't',
            'у': 'u', 'ф': 'f', 'х': 'kh', 'ц': 'ts', 'ч': 'ch',
            'ш': 'sh', 'щ': 'sh', 'ъ': '', 'ы': 'y', 'ь': '',
            'э': 'e', 'ю': 'yu', 'я': 'ya'
        };

        let latinName = '';
        let words = russianName.split(/\s+/);
        
        for (let word of words) {
            if (!word) continue;
            
            let latinWord = '';
            for (let i = 0; i < word.length; i++) {
                const char = word[i].toLowerCase();
                
                if (char === 'ь') continue;
                
                if (translitMap[char]) {
                    if (i === 0) {
                        const replacement = translitMap[char];
                        latinWord += replacement.charAt(0).toUpperCase() + replacement.slice(1);
                    } else {
                        latinWord += translitMap[char];
                    }
                } else {
                    latinWord += char;
                }
            }
            
            latinName += latinWord + ' ';
        }
        
        latinName = latinName.trim()
            .replace(/(\w+)iy\b/gi, '$1y')
            .replace(/(\w+)yy\b/gi, '$1y')
            .replace(/(\w+)y\b/gi, '$1y');
        
        latinNameElement.textContent = latinName;
        latinGroup.style.display = 'flex';
    } else {
        latinGroup.style.display = 'none';
    }
}

function copyBKName() {
    const latinName = document.getElementById('bkLatinName').textContent;
    if (latinName) {
        navigator.clipboard.writeText(latinName).then(() => {
            const copyButton = event.target;
            const originalHtml = copyButton.innerHTML;
            copyButton.innerHTML = '<i class="fas fa-check"></i> Скопировано';
            copyButton.classList.add('btn-success');
            
            setTimeout(() => {
                copyButton.innerHTML = originalHtml;
                copyButton.classList.remove('btn-success');
            }, 1500);
            
            showNotification('ФИО скопировано!');
        });
    }
}

// Функция для расчета корректировок
function nr() {
    const bloknot = document.getElementById('bloknot');
    const hideBtn = document.getElementById('hideBloknotBtn');
    
    bloknot.style.display = 'block';
    hideBtn.style.display = 'block';
    bloknot.value = '';
    
    const nrDate1 = document.getElementById('nrDate1').value;
    const nrDate2 = document.getElementById('nrDate2').value;
    const nrT1 = parseFloat(document.getElementById('nrT1').value) || 0;
    const nrT2 = parseFloat(document.getElementById('nrT2').value) || 0;
    const nrT3 = parseFloat(document.getElementById('nrT3').value) || 0;
    const nr1T1 = parseFloat(document.getElementById('nr1T1').value) || 0;
    const nr1T2 = parseFloat(document.getElementById('nr1T2').value) || 0;
    const nr1T3 = parseFloat(document.getElementById('nr1T3').value) || 0;
    
    if (!nrDate1 || !nrDate2) {
        showNotification('Пожалуйста, заполните обе даты', 'error');
        return;
    }
    
    const d1Parts = nrDate1.split('.');
    const d2Parts = nrDate2.split('.');
    
    const d1 = new Date(d1Parts[2], d1Parts[1] - 1, d1Parts[0]);
    const d2 = new Date(d2Parts[2], d2Parts[1] - 1, d2Parts[0]);
    
    const diffInMs = Math.abs(d2 - d1);
    const msInDay = 1000 * 60 * 60 * 24;
    const dp = Math.floor(diffInMs / msInDay);
    
    if (dp === 0) {
        showNotification('Даты не могут быть одинаковыми', 'error');
        return;
    }
    
    const drT1 = (nr1T1 - nrT1) / dp;
    const drT2 = (nr1T2 - nrT2) / dp;
    const drT3 = (nr1T3 - nrT3) / dp;
    
    const itogInputs = document.querySelectorAll('.nrItog');
    itogInputs.forEach(input => {
        const d3 = input.value;
        if (d3) {
            const d3Parts = d3.split('.');
            const CurDate = new Date(d3Parts[2], d3Parts[1] - 1, d3Parts[0]);
            const diffInMs1 = Math.abs(CurDate - d1);
            const dp1 = Math.floor(diffInMs1 / msInDay);
            
            const itogT1 = Math.floor(drT1 * dp1 + nrT1);
            const itogT2 = Math.floor(drT2 * dp1 + nrT2);
            const itogT3 = Math.floor(drT3 * dp1 + nrT3);
            
            // Только корректировочные показания без лишнего текста
            if (nrT2 === 0 && nrT3 === 0) {
                bloknot.value += `Корректировочные показания на ${d3} То ${itogT1} ;\n`;
            } else if (nrT3 === 0) {
                bloknot.value += `Корректировочные показания на ${d3} Т1 ${itogT1} ; Т2 ${itogT2} ;\n`;
            } else {
                bloknot.value += `Корректировочные показания на ${d3} Т1 ${itogT1} ; Т2 ${itogT2} ; Т3 ${itogT3} ;\n`;
            }
        }
    });
    
    bloknot.style.width = '1000px';
    bloknot.style.height = '250px';
}

// Вспомогательные функции
function formatDisplayDate(dateString) {
    if (!dateString) return '';
    if (dateString.includes('.')) return dateString;
    
    const parts = dateString.split('-');
    return `${parts[2]}.${parts[1]}.${parts[0]}`;
}

function showNotification(message, type = 'success') {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? '#28a745' : '#dc3545'};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 10000;
        font-size: 14px;
        animation: slideIn 0.3s ease;
    `;
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

function copyInvitation() {
    const invitationText = "Привет!\nЗацени этот инструмент — просто бомба для работы с шаблонами на МЭС! 🔥 https://triplecalc.github.io/AdjustmentV2/";
    
    navigator.clipboard.writeText(invitationText).then(() => {
        if (typeof ym !== 'undefined') {
            ym(103923903, 'reachGoal', 'share_invitation');
        }
        showNotification('Приглашение скопировано!');
    }).catch(err => {
        showNotification('Ошибка копирования', 'error');
    });
}

// Инициализация при загрузке
document.addEventListener('DOMContentLoaded', function() {
    // Установка дат по умолчанию
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('complaintDate').value = today;
    document.getElementById('paymentDate').value = today;
    
    const oneMonthAgo = new Date();
    oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
    document.getElementById('contractDate').value = oneMonthAgo.toISOString().split('T')[0];
    
    // Синхронизация дат оплаты
    document.getElementById('complaintDate').addEventListener('change', function() {
        document.getElementById('paymentDate').value = this.value;
    });
    
    // Обработка change log
    const changeLogTrigger = document.querySelector('.change-log-trigger');
    const changeLogContent = document.querySelector('.change-log-content');
    
    if (changeLogTrigger && changeLogContent) {
        changeLogTrigger.addEventListener('mouseenter', function() {
            changeLogContent.style.display = 'block';
        });
        
        changeLogTrigger.parentElement.addEventListener('mouseleave', function() {
            changeLogContent.style.display = 'none';
        });
    }
    
    // Скрытие блокнота
    document.getElementById('hideBloknotBtn').addEventListener('click', function() {
        document.getElementById('bloknot').style.display = 'none';
        this.style.display = 'none';
    });
});

// Добавление стилей для анимации
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    @keyframes slideOut {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);


// Дополнительная проверка на мобильные устройства
function isMobileDevice() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
           (window.innerWidth <= 768 && ('ontouchstart' in window || navigator.maxTouchPoints > 0));
}

document.addEventListener('DOMContentLoaded', function() {
    if (isMobileDevice()) {
        document.querySelector('.mobile-block').style.display = 'block';
        document.getElementById('accordion').style.display = 'none';
        document.querySelector('.email-templates-container').style.display = 'none';
    }
});
  </script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=103923903', 'ym');

    ym(103923903, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/103923903" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Добавить в конец body перед закрывающим тегом </body> -->
<div class="container-fluid mt-4 mb-4 text-center">
  <a href="https://forms.yandex.ru/u/68b1d4bf5056901afddd51d9" target="_blank" class="text-decoration-none mr-3" style="color: #6c757d; font-size: 14px; transition: color 0.3s ease;">
    <i class="fas fa-link mr-1"></i>
    Обратная связь | Подать обращение
  </a>
  
  <span class="text-decoration-none" style="color: #6c757d; font-size: 14px; cursor: pointer;" onclick="copyInvitation()">
    <i class="fas fa-share-alt mr-1"></i>
    Поделиться
  </span>
</div>

<!-- Change Log Menu -->
<div class="container-fluid mt-2 mb-2 text-center position-relative">
  <div class="change-log-container" style="display: inline-block;">
    <span class="change-log-trigger" style="color: #6c757d; font-size: 14px; cursor: pointer;">
      <i class="fas fa-info-circle mr-1"></i>
      Change Log
    </span>
    <div class="change-log-content" style="display: none; position: absolute; left: 50%; transform: translateX(-50%); background: white; border: 1px solid #ddd; padding: 15px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1000; width: 300px; margin-top: 10px;">
      <h6 style="font-weight: bold; margin-bottom: 10px;">Изменения в новой версии</h6>
      <p style="margin: 5px 0; font-size: 13px;">1. Добавлена вкладка change log чтобы было видно изменения в программе</p>
      <p style="margin: 5px 0; font-size: 13px;">2. Добавлен номер сборки <strong>v1.0.0 beta</strong></p>
	  <p style="margin: 5px 0; font-size: 13px;">3. Добавлено больше уведомлений для визуальной состовляющей</p>
	  <p style="margin: 5px 0; font-size: 13px;">1. Добавлена валидация дат в блок корректировок</p>
	  <p style="margin: 5px 0; font-size: 13px;">1. Изменён алгорит отображения расчётов. Теперь видно только корректировочные показания.
	  Если вы знаете, как можно визуально сделать лучше - появилась форма обратной связи для вопросов | предложений | Ошибок в работе ПО</p>
    </div>
  </div>
</div>



<script>
// Функция для показа/скрытия change log
document.querySelector('.change-log-trigger').addEventListener('mouseenter', function() {
  document.querySelector('.change-log-content').style.display = 'block';
});

document.querySelector('.change-log-container').addEventListener('mouseleave', function() {
  document.querySelector('.change-log-content').style.display = 'none';
});
</script>

</body>
	  </head>
</html>

